!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){const o=n(1),r=o(),s=n(2),a=o.Router(),i=n(3),u=new(n(4));let c,l;r.use(i.urlencoded({extended:!0})),r.use(i.json()),r.use(o.static(s.join(__dirname,"../build"))),r.use((function(e,t,n){t.header("Access-Control-Allow-Origin","*"),t.header("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept"),n()})),u.getMongoDB().then(e=>{c=e,l=c.collection("csv"),console.log("MOngodb connected")}).catch(e=>{console.log("Mongo Connection Failed",e)}),a.get("/",(e,t)=>{t.sendFile(s.join(__dirname,"..","build","index.html"))}),a.post("/getRows",async(e,t)=>{try{let n=e.body.pageNo,o=e.body.pageSize,r=e.body.sortCriteria,s=function(e){return Object.keys(e).length>0?e:{}}(e.body.filter),a=function(e){if(e.column){let t={};return t[e.column]="ascending"===e.order?1:-1,t}return{}}(r),i=await l.find(s).sort(a).skip((n-1)*o).limit(o).toArray(),u=await l.find().count();for(let e=0;e<i.length;e++){let t=i[e];delete t._id;let n=new Date(t.dob);t.dob=n.toISOString().split("T")[0],i[e]=t}t.status(200).send({data:i,total:u})}catch(e){t.status(500).send({error:e.message})}}),a.post("/setRows",async(e,t)=>{try{let n=e.body.data,o=e.body.columns;if(n=n.map(e=>{for(let t of o)"date"===t.dataType?e[t.name]=new Date(e[t.name]):"number"===t.dataType&&(e[t.name]=Number(e[t.name]));return e}),await l.findOne()&&await l.drop(),1!==(await l.insertMany(n)).result.ok)throw{message:"Could not save data"};t.status(200).send()}catch(e){t.status(500).send({error:e.message})}}),a.post("/reset",async(e,t)=>{try{let e=!1;if(await l.findOne()){e=await l.drop()}else e=!0;if(!e)throw{message:"Could not reset data"};t.status(200).send()}catch(e){t.status(500).send({error:e.message})}}),r.use("/",a),r.listen(3004,()=>console.log("Listening on 3004")),console.log("Running at Port 3004")},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("body-parser")},function(e,t,n){var o=n(5),r=n(6),s=o.MongoClient;e.exports=class{constructor(){}getMongoDB(){try{return new Promise((e,t)=>{s.connect(r.mongoConfig.URI,(function(n,o){n&&t(n);var s=o.db(r.mongoConfig.DB_NAME);e(s)}))})}catch(e){console.log(e)}}}},function(e,t){e.exports=require("mongodb")},function(e,t){e.exports={mongoConfig:{DB_NAME:"csvUploader",URI:"mongodb://localhost:27017/"}}}]);
//# sourceMappingURL=index.js.map